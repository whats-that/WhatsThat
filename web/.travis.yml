language: node_js
node_js:
  - node # uses most recent stable node version
services:
  - postgresql # starts up postgres
addons:
  postgresql: '9.6' # highest available postgres version on Travis
dist: trusty # uses trusty environment
sudo: false # when on trusty, uses Docker containers for speed
notifications:
  email:
    on_success: change # default: change (only when going from broken to fixed)
    on_failure: always # default: always (which is annoying, as it should be)
install:
  - npm ci # faster, goes only from package-lock
before_script:
  - psql -c 'create database "boilermaker-test";' -U postgres # remember to change this name if you change it elsewhere (e.g. package.json)

# before_deploy:
  - npm run build-client # make the bundle
  - rm -rf node_modules # omit from the tarball, since we skip cleanup
# deploy:
  skip_cleanup: true # prevents travis from deleting the build
  provider: heroku
  app: whatsthat-capstone
 # see README
  api_key:
    secure: "QpQQE4abH4HSHQUyLYFXrcT7DGN2SZ6dww0SBgleE6KubuYuwl2xxsYe+yJep1fvAu1gxdhycV5e1AP1B/d/FwEbVbrVxkroWCww1LELm0opXeTI+QOCi/Y0hHhgIG5ogJm0R8s19hUdRlW3OujC1jexhL7imKxQvp7gJDu4miDJeR/Oh+gk1JvGoGXx8ceej/1wSQXY6ROVI/OPt/9kwT431VbtSOeQlWF55/0i+nD/ZnSewfcmTPxQt4X3dsltyrwQh5LBN8vkpSU/gZvGZEKmGLTLLKYcuKCMgwt4Gowj3AmBTZZGXjyjoE+4jgIyVQuhjzLEZ2MedX+Gpl59BIVaRzBKEhat+rOVG1cnFD2yzma6opq30Ve03j4jHX42N29wAmv2PA5XaHp859MM+4UJD3rGL2CLDiedPlsLL46VgwxJTHivWbLeEnWBi7IIeP0MsuRb4dchIvNswCJzCfd4FpbGRNv/sDMHD2wtWCpB5FHsR64R8PqR5t9PKwokKPnLxm4MouCuF2k1Yi2oZUq9kjrgtRDSkRrGzjfeUXZZs5FILOvN9Gq3602y0b+uXHnHyQyEQqp1u8vguTUsW4wEShbwQIJwkcejSCq9KPnG8qzPCZMrRqC4tAfMLLg1IYIfshCAH3fxHEGAxESgEqmsDyJh8ERhX03jqTse3AY=" # see README
